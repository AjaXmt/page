(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[90],{46506:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>u});var l=t(95155),n=t(12115),s=t(81850),r=t(88524),i=t(97168),o=t(19946);let d=(0,o.A)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);var c=t(27213),p=t(66516);let h=(0,o.A)("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);var m=t(53999),y=t(81073),x=t(55028);function u(){let e=(0,n.useRef)(!0),a=(0,n.useRef)(null),{entries:o}=(0,s.E)(),[x,u]=(0,n.useState)([]),[k,b]=(0,n.useState)({key:"points",direction:"descending"}),[j,f]=(0,n.useState)(!1),[w,g]=(0,n.useState)([]);(0,n.useEffect)(()=>{if(e.current){try{let e=localStorage.getItem("battleResults")||"[]",a=JSON.parse(e);g(a)}catch(e){console.error("Error loading battle results:",e)}e.current=!1}},[]),(0,n.useEffect)(()=>{u([...o.map(e=>{let a=w.filter(a=>a.player1===e.player||a.player2===e.player),t=0,l=0,n=0;return a.forEach(a=>{a.player1===e.player?(t+=a.player1VP,l+=a.player2VP,"player1"===a.winner?n+=2:"draw"===a.winner&&(n+=1)):(t+=a.player2VP,l+=a.player1VP,"player2"===a.winner?n+=2:"draw"===a.winner&&(n+=1))}),{name:e.player,army:e.army,kp:e.kp,battlesPlayed:a.length,vpGained:t,vpLost:l,points:n}})].sort((e,a)=>e[k.key]<a[k.key]?"ascending"===k.direction?-1:1:e[k.key]>a[k.key]?"ascending"===k.direction?1:-1:0))},[o,w,k]);let v=(0,n.useCallback)(e=>{b(a=>{let t="ascending";return a.key===e&&"ascending"===a.direction&&(t="descending"),{key:e,direction:t}})},[]),C=(0,n.useCallback)(async()=>{if(!a.current){alert("Nie można znaleźć tabeli do eksportu");return}try{let e=(await t.e(316).then(t.t.bind(t,52699,23))).default,l=document.createElement("div");l.style.padding="20px",l.style.backgroundColor="#f5f0e6",l.style.fontFamily="Arial, sans-serif";let n=document.createElement("h2");n.textContent="Poznańska Kampania Old World - Tabela Wynik\xf3w",n.style.fontSize="20px",n.style.fontWeight="bold",n.style.marginBottom="10px",n.style.color="#8B0000";let s=document.createElement("p");s.textContent="Wygenerowano: ".concat(new Date().toLocaleDateString("pl-PL")),s.style.fontSize="12px",l.appendChild(n),l.appendChild(s);let r=document.createElement("div");r.style.backgroundColor="#f5f0e6",r.style.padding="20px",r.style.borderRadius="8px",r.style.boxShadow="0 4px 8px rgba(0,0,0,0.1)";let i=a.current.cloneNode(!0);i.querySelectorAll("thead button").forEach(e=>{var a;e.innerHTML=(null===(a=e.textContent)||void 0===a?void 0:a.trim().split(" ")[0])||""}),r.appendChild(l),r.appendChild(i),document.body.appendChild(r);let o=await e(r,{backgroundColor:"#f5f0e6",scale:2,logging:!1,useCORS:!0});document.body.removeChild(r);let d=o.toDataURL("image/jpeg",.9),c=document.createElement("a");c.href=d,c.download="kampania-tabela.jpg",c.click()}catch(e){console.error("Error generating JPG:",e),alert("Wystąpił błąd podczas generowania obrazu JPG")}},[]),P=(0,n.useCallback)(async()=>{try{let e=await Promise.all([t.e(930),t.e(913)]).then(t.bind(t,26597)),a=await t.e(118).then(t.bind(t,76118)),l=e.default,n=a.default,s=new l({orientation:"portrait",unit:"mm",format:"a4",putOnlyUsedFonts:!0,compress:!0});s.setFont("helvetica","bold"),s.setFontSize(16),s.text("Poznańska Kampania Old World - Tabela Wynik\xf3w",14,22);let r=new Date;s.setFont("helvetica","normal"),s.setFontSize(10),s.text("Wygenerowano: ".concat(r.toLocaleDateString("pl-PL")),14,30);let i=(e,a)=>e?e.length>a?e.substring(0,a)+"...":e:"",o=x.map(e=>[i((0,m.k)(e.name),12),i(e.army,15),e.kp,e.battlesPlayed,e.vpGained,e.vpLost,e.points]);n(s,{head:[["Gracz","Armia","KP","Bitwy","Zdobyte VP","Stracone VP","Punkty"]],body:o,startY:35,styles:{fontSize:8,cellPadding:2,font:"helvetica"},headStyles:{fillColor:[139,0,0],textColor:[255,255,255],fontStyle:"bold"},alternateRowStyles:{fillColor:[245,240,230]},didDrawCell:e=>{}}),s.save("kampania-tabela.pdf")}catch(e){console.error("Error generating PDF:",e),alert("Wystąpił błąd podczas generowania PDF")}},[x]),N=(0,n.useCallback)(()=>{f(e=>!e)},[]);return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold",children:"Tabela Wynik\xf3w"}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsxs)(i.$,{variant:"outline",className:"flex items-center gap-2",onClick:P,children:[(0,l.jsx)(d,{className:"h-4 w-4"}),"Eksportuj jako PDF"]}),(0,l.jsxs)(i.$,{variant:"outline",className:"flex items-center gap-2",onClick:C,children:[(0,l.jsx)(c.A,{className:"h-4 w-4"}),"Eksportuj jako JPG"]}),(0,l.jsxs)(i.$,{variant:"outline",className:"flex items-center gap-2",onClick:N,children:[(0,l.jsx)(p.A,{className:"h-4 w-4"}),"Udostępnij"]})]})]}),(0,l.jsx)("div",{ref:a,children:(0,l.jsxs)(r.XI,{children:[(0,l.jsx)(r.A0,{children:(0,l.jsxs)(r.Hj,{children:[(0,l.jsx)(r.nd,{className:"w-[200px]",children:(0,l.jsxs)(i.$,{variant:"ghost",onClick:()=>v("name"),children:["Imię i Nazwisko ",(0,l.jsx)(h,{className:"ml-2 h-4 w-4"})]})}),(0,l.jsx)(r.nd,{children:(0,l.jsxs)(i.$,{variant:"ghost",onClick:()=>v("army"),children:["Nazwa Armii ",(0,l.jsx)(h,{className:"ml-2 h-4 w-4"})]})}),(0,l.jsx)(r.nd,{children:(0,l.jsxs)(i.$,{variant:"ghost",onClick:()=>v("kp"),children:["KP ",(0,l.jsx)(h,{className:"ml-2 h-4 w-4"})]})}),(0,l.jsx)(r.nd,{children:(0,l.jsxs)(i.$,{variant:"ghost",onClick:()=>v("battlesPlayed"),children:["Liczba Bitew ",(0,l.jsx)(h,{className:"ml-2 h-4 w-4"})]})}),(0,l.jsx)(r.nd,{children:(0,l.jsxs)(i.$,{variant:"ghost",onClick:()=>v("vpGained"),children:["Zdobyte VP ",(0,l.jsx)(h,{className:"ml-2 h-4 w-4"})]})}),(0,l.jsx)(r.nd,{children:(0,l.jsxs)(i.$,{variant:"ghost",onClick:()=>v("vpLost"),children:["Stracone VP ",(0,l.jsx)(h,{className:"ml-2 h-4 w-4"})]})}),(0,l.jsx)(r.nd,{children:(0,l.jsxs)(i.$,{variant:"ghost",onClick:()=>v("points"),children:["Liczba Punkt\xf3w ",(0,l.jsx)(h,{className:"ml-2 h-4 w-4"})]})})]})}),(0,l.jsx)(r.BF,{children:x.map(e=>(0,l.jsxs)(r.Hj,{children:[(0,l.jsx)(r.nA,{className:"font-medium",children:(0,m.k)(e.name)}),(0,l.jsx)(r.nA,{children:e.army}),(0,l.jsx)(r.nA,{children:e.kp}),(0,l.jsx)(r.nA,{children:e.battlesPlayed}),(0,l.jsx)(r.nA,{children:e.vpGained}),(0,l.jsx)(r.nA,{children:e.vpLost}),(0,l.jsx)(r.nA,{children:e.points})]},e.name))})]})}),j&&(0,l.jsx)(y.o,{isOpen:j,onClose:()=>f(!1),data:x,title:"Tabela",description:"Udostępnij tabelę wynik\xf3w innym graczom"})]})}(0,x.default)(()=>Promise.all([t.e(930),t.e(913)]).then(t.bind(t,26597)),{loadableGenerated:{webpack:()=>[26597]},ssr:!1}),(0,x.default)(()=>t.e(118).then(t.bind(t,76118)),{loadableGenerated:{webpack:()=>[null]},ssr:!1}),(0,x.default)(()=>t.e(316).then(t.t.bind(t,52699,23)),{loadableGenerated:{webpack:()=>[52699]},ssr:!1})},59493:(e,a,t)=>{Promise.resolve().then(t.bind(t,46506))}},e=>{var a=a=>e(e.s=a);e.O(0,[277,692,694,587,441,684,358],()=>a(59493)),_N_E=e.O()}]);