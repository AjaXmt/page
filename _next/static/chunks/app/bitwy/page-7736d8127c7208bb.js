(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[482],{67437:(e,a,r)=>{Promise.resolve().then(r.bind(r,84972))},84972:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>$});var l=r(95155),s=r(12115),t=r(97168),n=r(89852),i=r(40968),d=r(74466),o=r(53999);let c=(0,d.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),p=s.forwardRef((e,a)=>{let{className:r,...s}=e;return(0,l.jsx)(i.b,{ref:a,className:(0,o.cn)(c(),r),...s})});p.displayName=i.b.displayName;var u=r(67820),m=r(5196);let x=s.forwardRef((e,a)=>{let{className:r,...s}=e;return(0,l.jsx)(u.bL,{ref:a,className:(0,o.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",r),...s,children:(0,l.jsx)(u.C1,{className:(0,o.cn)("flex items-center justify-center text-current"),children:(0,l.jsx)(m.A,{className:"h-4 w-4"})})})});x.displayName=u.bL.displayName;var y=r(81850),h=r(77740),f=r(47924);r(99840);let j=s.forwardRef((e,a)=>{let{className:r,...s}=e;return(0,l.jsx)(h.uB,{ref:a,className:(0,o.cn)("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",r),...s})});j.displayName=h.uB.displayName;let g=s.forwardRef((e,a)=>{let{className:r,...s}=e;return(0,l.jsxs)("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[(0,l.jsx)(f.A,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,l.jsx)(h.uB.Input,{ref:a,className:(0,o.cn)("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",r),...s})]})});g.displayName=h.uB.Input.displayName;let b=s.forwardRef((e,a)=>{let{className:r,...s}=e;return(0,l.jsx)(h.uB.List,{ref:a,className:(0,o.cn)("max-h-[300px] overflow-y-auto overflow-x-hidden",r),...s})});b.displayName=h.uB.List.displayName;let v=s.forwardRef((e,a)=>(0,l.jsx)(h.uB.Empty,{ref:a,className:"py-6 text-center text-sm",...e}));v.displayName=h.uB.Empty.displayName;let N=s.forwardRef((e,a)=>{let{className:r,...s}=e;return(0,l.jsx)(h.uB.Group,{ref:a,className:(0,o.cn)("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",r),...s})});N.displayName=h.uB.Group.displayName,s.forwardRef((e,a)=>{let{className:r,...s}=e;return(0,l.jsx)(h.uB.Separator,{ref:a,className:(0,o.cn)("-mx-1 h-px bg-border",r),...s})}).displayName=h.uB.Separator.displayName;let w=s.forwardRef((e,a)=>{let{className:r,...s}=e;return(0,l.jsx)(h.uB.Item,{ref:a,className:(0,o.cn)("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",r),...s})});w.displayName=h.uB.Item.displayName;var k=r(35178);let z=k.bL,C=k.l9,S=s.forwardRef((e,a)=>{let{className:r,align:s="center",sideOffset:t=4,...n}=e;return(0,l.jsx)(k.ZL,{children:(0,l.jsx)(k.UC,{ref:a,align:s,sideOffset:t,className:(0,o.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...n})})});S.displayName=k.UC.displayName;var A=r(10081);let R=["Scenariusz 1: Jatka pod Argalis","Scenariusz 2: Pamiątka po tacie","Scenariusz 3: Przeprawa przez Limnallę","Scenariusz 4: Polowanie na smoka","Scenariusz 5: Tajemnica G\xf3r Czarnych","Scenariusz 6: Złoto dla Zuchwałych"];function P(e){var a,r,i,d;let{onAddResult:c,initialBattle:u}=e,{entries:h}=(0,y.E)(),[f,k]=(0,s.useState)({player1:"",player2:"",winner:"draw",player1VP:0,player2VP:0,hasReport:!1,scenario:R[0]}),[P,E]=(0,s.useState)(!1),[B,L]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{u&&k(u)},[u]),(0,l.jsxs)("form",{onSubmit:e=>{e.preventDefault(),c(f),u||k({player1:"",player2:"",winner:"draw",player1VP:0,player2VP:0,hasReport:!1,scenario:R[0]})},className:"space-y-4",children:[(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(p,{htmlFor:"player1",children:"Gracz 1"}),(0,l.jsxs)(z,{open:P,onOpenChange:E,children:[(0,l.jsx)(C,{asChild:!0,children:(0,l.jsxs)(t.$,{variant:"outline",role:"combobox","aria-expanded":P,className:"w-full justify-between",children:[f.player1?"".concat((0,o.k)((null===(a=h.find(e=>e.player===f.player1))||void 0===a?void 0:a.player)||"")," - ").concat((null===(r=h.find(e=>e.player===f.player1))||void 0===r?void 0:r.army)||""):"Wybierz gracza 1...",(0,l.jsx)(A.A,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,l.jsx)(S,{className:"w-[300px] p-0",children:(0,l.jsxs)(j,{children:[(0,l.jsx)(g,{placeholder:"Szukaj gracza..."}),(0,l.jsxs)(b,{children:[(0,l.jsx)(v,{children:"Nie znaleziono gracza."}),(0,l.jsx)(N,{children:h.map(e=>(0,l.jsxs)(w,{onSelect:()=>{k({...f,player1:e.player===f.player1?"":e.player}),E(!1)},children:[(0,l.jsx)(m.A,{className:(0,o.cn)("mr-2 h-4 w-4",f.player1===e.player?"opacity-100":"opacity-0")}),(0,o.k)(e.player)," - ",e.army]},e.id))})]})]})})]})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(p,{htmlFor:"player2",children:"Gracz 2"}),(0,l.jsxs)(z,{open:B,onOpenChange:L,children:[(0,l.jsx)(C,{asChild:!0,children:(0,l.jsxs)(t.$,{variant:"outline",role:"combobox","aria-expanded":B,className:"w-full justify-between",children:[f.player2?"".concat((0,o.k)((null===(i=h.find(e=>e.player===f.player2))||void 0===i?void 0:i.player)||"")," - ").concat((null===(d=h.find(e=>e.player===f.player2))||void 0===d?void 0:d.army)||""):"Wybierz gracza 2...",(0,l.jsx)(A.A,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,l.jsx)(S,{className:"w-[300px] p-0",children:(0,l.jsxs)(j,{children:[(0,l.jsx)(g,{placeholder:"Szukaj gracza..."}),(0,l.jsxs)(b,{children:[(0,l.jsx)(v,{children:"Nie znaleziono gracza."}),(0,l.jsx)(N,{children:h.map(e=>(0,l.jsxs)(w,{onSelect:()=>{k({...f,player2:e.player===f.player2?"":e.player}),L(!1)},children:[(0,l.jsx)(m.A,{className:(0,o.cn)("mr-2 h-4 w-4",f.player2===e.player?"opacity-100":"opacity-0")}),(0,o.k)(e.player)," - ",e.army]},e.id))})]})]})})]})]})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(p,{htmlFor:"scenario",children:"Scenariusz"}),(0,l.jsx)("select",{id:"scenario",value:f.scenario,onChange:e=>k({...f,scenario:e.target.value}),className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",children:R.map(e=>(0,l.jsx)("option",{value:e,children:e},e))})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(p,{children:"Wynik"}),(0,l.jsxs)("div",{className:"flex space-x-4",children:[(0,l.jsxs)(p,{className:"flex items-center space-x-2",children:[(0,l.jsx)("input",{type:"radio",name:"winner",value:"player1",checked:"player1"===f.winner,onChange:()=>k({...f,winner:"player1"})}),(0,l.jsx)("span",{children:"Wygrana Gracza 1"})]}),(0,l.jsxs)(p,{className:"flex items-center space-x-2",children:[(0,l.jsx)("input",{type:"radio",name:"winner",value:"player2",checked:"player2"===f.winner,onChange:()=>k({...f,winner:"player2"})}),(0,l.jsx)("span",{children:"Wygrana Gracza 2"})]}),(0,l.jsxs)(p,{className:"flex items-center space-x-2",children:[(0,l.jsx)("input",{type:"radio",name:"winner",value:"draw",checked:"draw"===f.winner,onChange:()=>k({...f,winner:"draw"})}),(0,l.jsx)("span",{children:"Remis"})]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(p,{htmlFor:"player1VP",children:"VP Gracza 1"}),(0,l.jsx)(n.p,{id:"player1VP",type:"number",value:f.player1VP,onChange:e=>k({...f,player1VP:Number(e.target.value)})})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(p,{htmlFor:"player2VP",children:"VP Gracza 2"}),(0,l.jsx)(n.p,{id:"player2VP",type:"number",value:f.player2VP,onChange:e=>k({...f,player2VP:Number(e.target.value)})})]})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(x,{id:"hasReport",checked:f.hasReport,onCheckedChange:e=>k({...f,hasReport:e})}),(0,l.jsx)(p,{htmlFor:"hasReport",children:"Raport z bitwy"})]}),f.hasReport&&(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(p,{htmlFor:"reportLink",children:"Link do raportu"}),(0,l.jsx)(n.p,{id:"reportLink",type:"url",value:f.reportLink||"",onChange:e=>k({...f,reportLink:e.target.value}),placeholder:"https://facebook.com/..."})]}),(0,l.jsx)(t.$,{type:"submit",children:u?"Aktualizuj":"Dodaj wynik bitwy"})]})}var E=r(88524),B=r(6874),L=r.n(B),V=r(66516),G=r(89917),O=r(62525),_=r(91788),I=r(29869),F=r(27213),J=r(81073),W=r(35695);function $(){let e=(0,s.useRef)(!0),a=(0,s.useRef)(null),[n,i]=(0,s.useState)([]),[d,c]=(0,s.useState)(null),[p,u]=(0,s.useState)(!1),{entries:m}=(0,y.E)(),x=(0,W.useSearchParams)();(0,s.useEffect)(()=>{if(!e.current)return;let a=x.get("data");if(a)try{let e=atob(a),r=JSON.parse(e);Array.isArray(r)&&(i(r),localStorage.setItem("battleResults",JSON.stringify(r)))}catch(e){console.error("Error parsing shared data:",e)}else try{let e=localStorage.getItem("battleResults");e&&i(JSON.parse(e))}catch(e){console.error("Error loading battle results from localStorage:",e)}e.current=!1},[x]);let h=(0,s.useCallback)(e=>{try{localStorage.setItem("battleResults",JSON.stringify(e))}catch(e){console.error("Error saving battle results to localStorage:",e)}},[]),f=(0,s.useCallback)(e=>{let a={...e,id:Date.now()};i(e=>{let r=[...e,a];return h(r),r})},[h]),j=(0,s.useCallback)(()=>{h(n),alert("Wyniki bitew zostały zapisane!")},[n,h]),g=(0,s.useCallback)(e=>{c(e)},[]),b=(0,s.useCallback)(e=>{i(a=>{let r=a.map(a=>a.id===e.id?e:a);return h(r),r}),c(null)},[h]),v=(0,s.useCallback)(e=>{i(a=>{let r=a.filter(a=>a.id!==e);return h(r),r})},[h]),N=(0,s.useCallback)(()=>{let e="data:application/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(n)),a=document.createElement("a");a.setAttribute("href",e),a.setAttribute("download","battle-results.json"),a.click()},[n]),w=(0,s.useCallback)(e=>{var a;let r=new FileReader;r.readAsText(null===(a=e.target.files)||void 0===a?void 0:a[0],"UTF-8"),r.onload=e=>{var a;let r=null===(a=e.target)||void 0===a?void 0:a.result;try{let e=JSON.parse(r);i(e),h(e),alert("Dane zostały zaimportowane pomyślnie!")}catch(e){alert("Błąd podczas importowania danych!")}}},[h]),k=(0,s.useCallback)(async()=>{if(!a.current){alert("Nie można znaleźć tabeli do eksportu");return}try{let e=(await r.e(316).then(r.t.bind(r,52699,23))).default,l=document.createElement("div");l.style.padding="20px",l.style.backgroundColor="#f5f0e6",l.style.fontFamily="Arial, sans-serif";let s=document.createElement("h2");s.textContent="Poznańska Kampania Old World - Wyniki Bitew",s.style.fontSize="20px",s.style.fontWeight="bold",s.style.marginBottom="10px",s.style.color="#8B0000";let t=document.createElement("p");t.textContent="Wygenerowano: ".concat(new Date().toLocaleDateString("pl-PL")),t.style.fontSize="12px",l.appendChild(s),l.appendChild(t);let n=document.createElement("div");n.style.backgroundColor="#f5f0e6",n.style.padding="20px",n.style.borderRadius="8px",n.style.boxShadow="0 4px 8px rgba(0,0,0,0.1)";let i=a.current.cloneNode(!0),d=i.querySelectorAll("thead th"),o=Array.from(d).findIndex(e=>"Raport"===e.textContent),c=Array.from(d).findIndex(e=>"Akcje"===e.textContent);-1!==o&&(d[o].style.display="none",i.querySelectorAll("tbody tr").forEach(e=>{let a=e.querySelectorAll("td");a[o]&&(a[o].style.display="none")})),-1!==c&&(d[c].style.display="none",i.querySelectorAll("tbody tr").forEach(e=>{let a=e.querySelectorAll("td");a[c]&&(a[c].style.display="none")})),n.appendChild(l),n.appendChild(i),document.body.appendChild(n);let p=await e(n,{backgroundColor:"#f5f0e6",scale:2,logging:!1,useCORS:!0});document.body.removeChild(n);let u=p.toDataURL("image/jpeg",.9),m=document.createElement("a");m.href=u,m.download="kampania-bitwy.jpg",m.click()}catch(e){console.error("Error generating JPG:",e),alert("Wystąpił błąd podczas generowania obrazu JPG")}},[]),z=(0,s.useCallback)(()=>{u(e=>!e)},[]);return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold",children:"Bitwy"}),(0,l.jsxs)(t.$,{variant:"outline",className:"flex items-center gap-2",onClick:z,children:[(0,l.jsx)(V.A,{className:"h-4 w-4"}),"Udostępnij"]})]}),null===d?(0,l.jsx)(P,{onAddResult:f}):(0,l.jsx)(P,{onAddResult:b,initialBattle:n.find(e=>e.id===d)}),(0,l.jsx)("div",{className:"rounded-md border",ref:a,children:(0,l.jsxs)(E.XI,{children:[(0,l.jsx)(E.A0,{children:(0,l.jsxs)(E.Hj,{children:[(0,l.jsx)(E.nd,{children:"Gracz 1"}),(0,l.jsx)(E.nd,{children:"Gracz 2"}),(0,l.jsx)(E.nd,{children:"Scenariusz"}),(0,l.jsx)(E.nd,{children:"Zwycięzca"}),(0,l.jsx)(E.nd,{children:"VP Gracza 1"}),(0,l.jsx)(E.nd,{children:"VP Gracza 2"}),(0,l.jsx)(E.nd,{children:"Raport"}),(0,l.jsx)(E.nd,{children:"Akcje"})]})}),(0,l.jsx)(E.BF,{children:n.map(e=>{var a,r;return(0,l.jsxs)(E.Hj,{children:[(0,l.jsxs)(E.nA,{children:[(0,o.k)(e.player1),(0,l.jsx)("div",{className:"text-xs text-muted-foreground",children:(null===(a=m.find(a=>a.player===e.player1))||void 0===a?void 0:a.army)||""})]}),(0,l.jsxs)(E.nA,{children:[(0,o.k)(e.player2),(0,l.jsx)("div",{className:"text-xs text-muted-foreground",children:(null===(r=m.find(a=>a.player===e.player2))||void 0===r?void 0:r.army)||""})]}),(0,l.jsx)(E.nA,{children:e.scenario}),(0,l.jsx)(E.nA,{children:"player1"===e.winner?(0,o.k)(e.player1):"player2"===e.winner?(0,o.k)(e.player2):"Remis"}),(0,l.jsx)(E.nA,{children:e.player1VP}),(0,l.jsx)(E.nA,{children:e.player2VP}),(0,l.jsx)(E.nA,{children:e.hasReport&&e.reportLink?(0,l.jsx)(L(),{href:e.reportLink,target:"_blank",className:"text-blue-600 hover:underline",children:"Link do raportu"}):"Brak"}),(0,l.jsx)(E.nA,{children:(0,l.jsxs)("div",{className:"flex space-x-2",children:[(0,l.jsxs)(t.$,{variant:"outline",size:"sm",onClick:()=>g(e.id),children:[(0,l.jsx)(G.A,{className:"h-4 w-4 mr-2"}),"Edytuj"]}),(0,l.jsxs)(t.$,{variant:"destructive",size:"sm",onClick:()=>v(e.id),children:[(0,l.jsx)(O.A,{className:"h-4 w-4 mr-2"}),"Usuń"]})]})})]},e.id)})})]})}),(0,l.jsx)(t.$,{onClick:j,children:"Zapisz"}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-2 mt-4",children:[(0,l.jsxs)(t.$,{onClick:N,variant:"outline",className:"flex items-center gap-2",children:[(0,l.jsx)(_.A,{className:"h-4 w-4"}),"Eksportuj JSON"]}),(0,l.jsxs)(t.$,{variant:"outline",className:"flex items-center gap-2",onClick:()=>{var e;return null===(e=document.getElementById("file-input"))||void 0===e?void 0:e.click()},children:[(0,l.jsx)(I.A,{className:"h-4 w-4"}),"Importuj dane",(0,l.jsx)("input",{id:"file-input",type:"file",accept:".json",onChange:w,style:{display:"none"}})]}),(0,l.jsxs)(t.$,{onClick:k,variant:"outline",className:"flex items-center gap-2",children:[(0,l.jsx)(F.A,{className:"h-4 w-4"}),"Eksportuj jako JPG"]})]}),p&&(0,l.jsx)(J.o,{isOpen:p,onClose:()=>u(!1),data:n,title:"Bitwy",description:"Udostępnij wyniki bitew innym graczom"})]})}(0,r(55028).default)(()=>r.e(316).then(r.t.bind(r,52699,23)),{loadableGenerated:{webpack:()=>[52699]},ssr:!1})},89852:(e,a,r)=>{"use strict";r.d(a,{p:()=>n});var l=r(95155),s=r(12115),t=r(53999);let n=s.forwardRef((e,a)=>{let{className:r,type:s,...n}=e;return(0,l.jsx)("input",{type:s,className:(0,t.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:a,...n})});n.displayName="Input"}},e=>{var a=a=>e(e.s=a);e.O(0,[277,692,694,244,942,587,441,684,358],()=>a(67437)),_N_E=e.O()}]);